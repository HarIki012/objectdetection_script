# EVS和EDFFN模块详细分析 https://arxiv.org/pdf/2405.14343

## EVS（高效视觉扫描）模块

### 1. 背景
传统的状态空间模型（如Mamba）是为处理一维序列数据而设计的，直接应用到视觉任务时需要将图像数据展平为一维序列，这会破坏图像的空间结构，难以捕获来自各种相邻像素的局部信息[2]。

现有的视觉状态空间模型大多采用多方向扫描机制来利用状态空间模型，但这种策略显著增加了计算成本。例如，VMamba的计算成本比Mamba高4倍，因为它在纵向和横向方向上执行双向扫描[5]。

### 2. 模块原理
EVS模块的核心创新是**几何变换+单方向扫描**的策略[5]：

**几何变换策略**：
```
G = {
    Transpose(Fin)  if i % 2 = 0
    Flip(Fin)       if i % 2 = 1
}
```
其中i是网络中第i个EVSS模块的索引，Flip操作沿特征的水平和垂直轴进行翻转[6]。

**扫描过程**：
1. 首先对输入特征应用几何变换
2. 通过1×1卷积分割特征为X1和X2
3. 对X1应用深度卷积和选择性扫描S6
4. 对X2应用激活函数
5. 最终通过1×1卷积融合结果[7]

**空间结构恢复**：图像特征在每4个EVSS模块后自动恢复到原始空间结构，如果总模块数不能被4整除，可以通过相应的逆变换来恢复原始空间结构[6]。

### 3. 解决的问题
- **空间信息丢失问题**：通过几何变换保持了图像的空间结构信息，避免了简单展平造成的信息损失[5]
- **计算复杂度问题**：相比多方向扫描，EVS模块在保持相同参数量和FLOPs的情况下，运行时间从182.6ms降低到88.7ms[12]
- **非局部信息探索**：通过不同的几何变换，每次扫描都能捕获来自不同方向的上下文信息，有效探索非局部信息[12]

## EDFFN（高效判别频域FFN）模块

### 1. 背景
FFN部分通常是深度学习模型的核心组件，有助于潜在清晰图像的重建[7]。FFTformer开发了一种判别频域FFN（DFFN），能够自适应地确定应该保留哪些频率信息，但这在执行频域操作时增加了计算成本[7]。

### 2. 模块原理
EDFFN的核心设计理念是**频域筛选后置**[7]：

**与DFFN的区别**：
- DFFN：在FFN网络的中间应用频域操作
- EDFFN：在FFN网络的最终阶段执行频域筛选[7]

**模块结构**：
1. 输入特征经过归一化
2. 通过1×1卷积进行特征变换
3. 应用深度卷积和GELU激活
4. 在最终阶段进行频域筛选操作
5. 通过1×1卷积输出最终特征[4]

### 3. 解决的问题
- **计算效率问题**：通过将频域操作后置到FFN的最终阶段，相比在中间阶段进行频域操作的DFFN，显著降低了计算成本[7]
- **特征变换效率**：有效且高效地变换来自EVSS模块的特征，为潜在清晰图像重建提供支持[7]
- **频率信息选择**：保持了对有用频率信息的自适应选择能力，同时提高了计算效率[7]

## 模块协同效果

EVS和EDFFN模块的结合使得EVSSM能够：
1. **高效处理视觉数据**：EVS模块通过几何变换适配SSM到视觉任务
2. **有效特征变换**：EDFFN模块高效地处理和筛选频域特征
3. **整体性能提升**：两个模块协同工作，在GoPro数据集上相比基线方法PSNR提升0.14dB，同时保持相同的参数量和计算复杂度[12]