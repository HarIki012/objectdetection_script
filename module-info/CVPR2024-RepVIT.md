### RepViT Block模块总结 https://arxiv.org/pdf/2307.09283

#### 1. 背景

**原始问题**：
- MobileNetV3采用的是传统的倒残差瓶颈结构，其中Token Mixer（空间信息融合）和Channel Mixer（通道交互）是耦合在一起的[6]
- 具体来说，MobileNetV3 block包含1×1扩展卷积、3×3深度卷积（DW）和1×1投影层，这种设计使得空间和通道的处理混合在一起[6]
- 轻量级ViT的成功很大程度上归因于其采用的MetaFormer架构，该架构将Token Mixer和Channel Mixer分离，这种设计被证明是有效的[6]

**设计动机**：
- 研究发现ViT的有效性主要来源于其通用的Token Mixer和Channel Mixer架构（即MetaFormer架构），而不是特定的Token Mixer[6]
- 为了让轻量级CNN也能享受这种架构优势，需要在MobileNetV3中实现Token Mixer和Channel Mixer的分离[6]

#### 2. 模块原理

**结构设计**：
- **分离设计**：将原本耦合的Token Mixer和Channel Mixer进行分离
  - Token Mixer：3×3深度卷积（DW），负责空间信息融合
  - Channel Mixer：1×1卷积层，负责通道间的交互[6][7]

- **层序调整**：
  - 将3×3 DW卷积前移，使其独立处理空间信息
  - SE层（如果存在）也随之前移，放置在DW卷积之后，因为SE层依赖于空间信息交互[7]

- **结构重参数化**：
  - 对DW层采用广泛使用的结构重参数化技术，在训练时使用多分支结构增强学习能力
  - 在推理时可以将多分支合并为单一卷积，消除跳跃连接带来的计算和内存开销[7]

**具体结构对比**：
- **MobileNetV3 Block**：1×1扩展 → 3×3 DW → SE（可选）→ 1×1投影
- **RepViT Block**：3×3 DW → SE（可选）→ 1×1扩展 → 1×1投影[7]

#### 3. 解决了什么问题

**性能提升**：
- **架构优化**：通过分离Token Mixer和Channel Mixer，使模型能够更好地处理空间和通道信息，提升了模型的表达能力[6][7]

**效率优化**：
- **延迟降低**：RepViT block将MobileNetV3-L的延迟从1.01ms降低到0.81ms[7]
- **推理优化**：结构重参数化技术在推理时消除了跳跃连接的计算开销，这对移动设备特别有利[7]

**训练增强**：
- **学习能力**：结构重参数化技术在训练时提供多分支结构，增强了模型的学习能力，同时在推理时保持单分支的效率[7]

**架构统一**：
- **设计一致性**：使轻量级CNN的架构与成功的轻量级ViT保持一致，为后续的优化提供了良好的基础[6]

**注意**：虽然RepViT block在延迟上有显著改善，但初期会带来临时的性能下降（从71.5%降至68.3%），这通过后续的扩展比例调整和网络宽度增加得到了补偿[7]