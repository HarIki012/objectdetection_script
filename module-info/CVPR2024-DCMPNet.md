# LEGM和MFM模块详细总结 https://arxiv.org/pdf/2403.01105

## LEGM模块 (Local Feature-embedded Global Feature Extraction Module)

### 1. 背景
在图像去雾任务中，传统的卷积神经网络主要擅长提取局部特征，但在处理全局信息和长距离依赖关系方面存在局限性[7]。为了有效融合局部和全局特征信息，提高去雾网络的特征表示能力，作者设计了LEGM模块。

### 2. 模块原理
LEGM模块的核心组件是自注意力块(self-attention block)[7]，其输入包括：
- U-Net输出经过1×1卷积后的特征
- 经过3×3卷积的特征  
- 深度估计网络(DE)后经过DRDB处理的特征

**工作机制**：
- 将卷积层与自注意力块相结合，命名为LEGM[7]
- 在深度信息辅助去雾中，只有第一个LEGM接收雾霾图像的深度信息[7]
- 去雾网络编码器包含三个LEGM，其输出通过MSAAM进行整合以防止浅层特征丢失[7]

### 3. 解决的问题
- **局部-全局特征融合**：有效结合了卷积网络的局部特征提取能力和自注意力机制的全局建模能力
- **特征表示增强**：显著提升了网络的特征表示能力，消融实验显示相比基线模型PSNR提升了4.72dB[13]
- **深度信息集成**：为深度信息的有效利用提供了合适的特征融合机制

---

## MFM模块 (Modulation Fusion Module)

### 1. 背景
在去雾网络的解码过程中，需要有效融合来自不同层次和不同来源的特征信息。传统的特征融合方法（如简单相加或拼接）无法自适应地调整不同特征的重要性，可能导致关键信息被稀释或丢失[8]。

### 2. 模块原理
MFM模块采用动态权重调制的特征融合策略[8]：

**输入处理**：
- 第一个MFM的输入是F̂¹ₗₑₘ和经过3×3卷积处理的特征F¹ᵣc
- 将F̂¹ₗₑₘ和F¹ᵣc相加后，经过GAP(全局平均池化)、MLP和Softmax处理，得到权重矩阵A¹ᵣ,c[8]

**特征调制**：
权重矩阵A¹ᵣ,c中的数值表示F̂¹ₗₑₘ和F¹ᵣc在去雾图像重建中的重要性程度。通过A¹ᵣ,c进行调制的具体过程为[8]：
```
F̃¹ᵣc = A¹ᵣ,c ⊙ F̂¹ₗₑₘ + A¹ᵣ,c ⊙ F¹ᵣc
```

**特征整合**：
- 将F̃¹ᵣc和F̂¹ₗₑₘ进行拼接以增强它们之间的共享信息
- 拼接结果经过卷积层处理，产生第一个带FMI的LEGM输出[8]

### 3. 解决的问题
- **自适应特征融合**：通过动态调整融合权重，突出对去雾重建贡献更大的特征信息
- **特征表示增强**：提升网络的特征表示能力，消融实验显示在LEGM基础上进一步改善了模型性能[13]
- **信息保持**：通过权重调制机制，确保重要的特征信息在融合过程中得到保留和强化
- **跨通道特征交互**：促进不同通道间的特征交互，提高整体的特征表达能力[14]

---

## 模块协同作用

LEGM和MFM模块在整个网络架构中形成了有效的协同作用：
- **LEGM**负责局部-全局特征的有效提取和融合
- **MFM**负责不同特征间的自适应融合和调制
- 两个模块共同构成了去雾网络解码器中的核心组件，实现了高质量的特征重建和图像恢复[8]